(window.webpackJsonp=window.webpackJsonp||[]).push([[209],{523:function(s,t,a){"use strict";a.r(t);var e=a(27),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[s._v("#")]),s._v(" MySQL")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL"),t("OutboundLink")],1),s._v(" 是一种流行的开源关系型数据库管理系统（RDBMS），广泛应用于各种类型的应用程序中，尤其是在基于互联网的应用程序中。")]),s._v(" "),t("h2",{attrs:{id:"一、安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、安装"}},[s._v("#")]),s._v(" 一、安装")]),s._v(" "),t("h3",{attrs:{id:"yum"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yum"}},[s._v("#")]),s._v(" YUM")]),s._v(" "),t("p",[s._v("添加 MySQL Yum "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/linux-installation-yum-repo.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("存储库"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" https://repo.mysql.com/mysql80-community-release-el7-7.noarch.rpm     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对于基于 EL7 的系统")]),s._v("\n")])])]),t("p",[s._v("选择发布系列。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum-config-manager "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--disable")]),s._v(" mysql80-community\nyum-config-manager "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--enable")]),s._v(" mysql57-community\n")])])]),t("p",[s._v("安装 MySQL。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mysql-community-server\n")])])]),t("p",[s._v("腾讯镜像加速。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/http/s@repo.mysql.com@mirrors.cloud.tencent.com/mysql@g'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/http/s@/el/7/@-el7-@g'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" /etc/yum.repos.d/mysql-community.repo\n")])])]),t("p",[s._v("启动 MySQL 服务器。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("systemctl start mysqld\n")])])]),t("p",[s._v("在服务器初始启动时，如果服务器的数据目录为空，则会发生以下情况。")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("1、服务器初始化。\n2、SSL 证书和密钥文件在数据目录中生成。\n3、validate_password 默认安装并启用。\n4、创建超级用户帐户 'root'@'localhost'。超级用户的默认密码存储在错误日志文件中。\n")])])]),t("p",[s._v("要显示超级用户的默认密码，请使用以下命令。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'temporary password'")]),s._v(" /var/log/mysqld.log\n")])])]),t("h3",{attrs:{id:"apt"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#apt"}},[s._v("#")]),s._v(" APT")]),s._v(" "),t("p",[s._v("从 Debian 9（Stretch）开始，Debian 官方库中的 "),t("a",{attrs:{href:"https://wiki.debian.org/MySql",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySql"),t("OutboundLink")],1),s._v(" 被 MariaDB 替代。")]),s._v(" "),t("p",[s._v("将 "),t("a",{attrs:{href:"https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL APT"),t("OutboundLink")],1),s._v(" 存储库添加到系统的软件存储库列表中。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dev.mysql.com/get/mysql-apt-config_0.8.33-1_all.deb\ndpkg "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" mysql-apt-config_0.8.33-1_all.deb\n")])])]),t("p",[s._v("安装 MySQL。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mysql-server\n")])])]),t("h2",{attrs:{id:"二、账户管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、账户管理"}},[s._v("#")]),s._v(" 二、账户管理")]),s._v(" "),t("h3",{attrs:{id:"修改账户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改账户"}},[s._v("#")]),s._v(" 修改账户")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/alter-user.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("ALTER USER")]),t("OutboundLink")],1),s._v(" 语句可以修改 MySQL 帐户。它支持为现有帐户修改身份验证、SSL/TLS、资源限制和密码管理属性，它还可用于锁定和解锁帐户。")]),s._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/assigning-passwords.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("更改用户密码"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'localhost'")]),s._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'new_password'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("更改服务器用于验证当前客户端的 MySQL 帐户的用户密码")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CURRENT_USER")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'new_password'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("更改当前 MySQL 帐户的用户密码")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'new_password'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])]),s._v(" "),t("h3",{attrs:{id:"权限管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#权限管理"}},[s._v("#")]),s._v(" 权限管理")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/grant.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("GRANT")]),t("OutboundLink")],1),s._v(" 语句将权限授予 MySQL 用户帐户。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("查询用户名和主机名")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" host "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("全局授予所有权限。账户不存在时，自动创建。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("全局授予所有权限。账户不存在时，带密码自动创建。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),s._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'auth_string'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("全局授予所有权限。账户不存在时，带密码自动创建；允许向其他用户授予或撤销自己拥有的权限。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),s._v(" IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'auth_string'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OPTION")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/flush.html#flush-privileges",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("FLUSH PRIVILEGES")]),t("OutboundLink")],1),s._v(" 语句可以从 "),t("code",[s._v("mysql")]),s._v(" 系统数据库的 "),t("code",[s._v("grant")]),s._v(" 表中重新读取权限。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("FLUSH "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"帐户名称"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#帐户名称"}},[s._v("#")]),s._v(" 帐户名称")]),s._v(" "),t("p",[s._v("MySQL "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/account-names.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("帐户名"),t("OutboundLink")],1),s._v("由用户名和主机名组成，这使得从不同主机连接的具有相同用户名的用户可以创建不同的帐户。")]),s._v(" "),t("p",[s._v("账户名出现在 "),t("code",[s._v("CREATE USER")]),s._v("、"),t("code",[s._v("GRANT")]),s._v(" 和 "),t("code",[s._v("SET PASSWORD")]),s._v(" 等 SQL 语句中并遵循以下规则。")]),s._v(" "),t("ul",[t("li",[s._v("帐户名语法为 "),t("code",[s._v("'user_name'@'host_name'")]),s._v("。")]),s._v(" "),t("li",[t("code",[s._v("@'host_name'")]),s._v(" 部分是可选的。仅由用户名组成的帐户名等同于 "),t("code",[s._v("'user_name'@'%'")]),s._v("。例如，"),t("code",[s._v("'me'")]),s._v(" 等同于 "),t("code",[s._v("'me'@'%'")]),s._v("。")]),s._v(" "),t("li",[s._v("如果用户名和主机名作为未加引号的标识符是合法的，则不需要加引号。如果 "),t("code",[s._v("user_name")]),s._v(" 字符串包含特殊字符，或者 "),t("code",[s._v("host_name")]),s._v(" 字符串包含特殊字符或通配符，则必须使用引号。")])]),s._v(" "),t("h3",{attrs:{id:"变量赋值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#变量赋值"}},[s._v("#")]),s._v(" 变量赋值")]),s._v(" "),t("p",[s._v("获得"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("系统变量"),t("OutboundLink")],1),s._v("的会话值或全局值。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" @"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@validate_password_policy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" VARIABLES "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("LIKE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'datadir'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("设置全局系统变量。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v(" max_connections "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" @"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@GLOBAL.max_connections")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("设置会话系统变量。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SESSION")]),s._v(" sql_mode "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'TRADITIONAL'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" @"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@SESSION.sql_mode")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'TRADITIONAL'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" @"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@sql_mode")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'TRADITIONAL'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"三、条件约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、条件约束"}},[s._v("#")]),s._v(" 三、条件约束")]),s._v(" "),t("h3",{attrs:{id:"自增长约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自增长约束"}},[s._v("#")]),s._v(" 自增长约束")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/example-auto-increment.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("AUTO_INCREMENT")]),t("OutboundLink")],1),s._v(" 约束可用于为新行生成唯一标识。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" users "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  username "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"四、命令行程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、命令行程序"}},[s._v("#")]),s._v(" 四、命令行程序")]),s._v(" "),t("h3",{attrs:{id:"mysql-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-2"}},[s._v("#")]),s._v(" mysql")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/mysql.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("mysql")]),t("OutboundLink")],1),s._v(" 是一个简单的 SQL Shell。")]),s._v(" "),t("p",[s._v("从命令行中调用它，如下所示。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("user_name "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--password")]),s._v(" db_name\n")])])]),t("p",[t("code",[s._v("mysql")]),s._v(" "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/mysql-command-options.html",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("选项")]),t("OutboundLink")],1),s._v("：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("--"),t("strong",[s._v("user")]),s._v("="),t("em",[s._v("user_name")]),s._v(", -"),t("strong",[s._v("u")]),s._v(" "),t("em",[s._v("user_name")])]),s._v(" "),t("p",[s._v("连接到服务器时使用的 MySQL 用户名。")])]),s._v(" "),t("li",[t("p",[s._v("--"),t("strong",[s._v("password")]),s._v("[="),t("em",[s._v("password")]),s._v("], -"),t("strong",[s._v("p")]),s._v("["),t("em",[s._v("password")]),s._v("]")]),s._v(" "),t("p",[s._v("连接到服务器时使用的密码。")])]),s._v(" "),t("li",[t("p",[s._v("--"),t("strong",[s._v("port")]),s._v("="),t("em",[s._v("port_num")]),s._v(", -"),t("strong",[s._v("P")]),s._v(" "),t("em",[s._v("port_num")])]),s._v(" "),t("p",[s._v("用于连接的 TCP/IP 端口号。")])]),s._v(" "),t("li",[t("p",[s._v("--"),t("strong",[s._v("host")]),s._v("="),t("em",[s._v("host_name")]),s._v(", -"),t("strong",[s._v("h")]),s._v(" "),t("em",[s._v("host_name")])]),s._v(" "),t("p",[s._v("MySQL 服务器所在的主机。")])])]),s._v(" "),t("p",[t("code",[s._v("mysql")]),s._v(" "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/mysql-commands.html",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("命令")]),t("OutboundLink")],1),s._v("：")]),s._v(" "),t("p",[t("code",[s._v("mysql")]),s._v(" 会将发出的每个 SQL 语句发送到要执行的服务器，同时还有一组 "),t("code",[s._v("mysql")]),s._v(" 自己解释的命令。")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("status")]),s._v(", "),t("code",[s._v("\\s")])]),s._v(" "),t("p",[s._v("从服务器获取状态信息。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("\\u")]),s._v(" "),t("em",[s._v("db_name")])]),s._v(" "),t("p",[s._v("使用 "),t("code",[s._v("db_name")]),s._v(" 作为默认数据库。")])])]),s._v(" "),t("h3",{attrs:{id:"mysqladmin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysqladmin"}},[s._v("#")]),s._v(" mysqladmin")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/mysqladmin.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("mysqladmin")]),t("OutboundLink")],1),s._v(" 是用于执行管理操作的客户端。可以使用它来检查服务器的配置和当前状态，创建和删除数据库等等。")]),s._v(" "),t("p",[s._v("从命令行中调用它，如下所示。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("mysqladmin "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("user_name "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--password")]),s._v(" flush-privileges\n")])])]),t("p",[t("code",[s._v("mysqladmin")]),s._v(" "),t("strong",[s._v("选项")]),s._v("：")]),s._v(" "),t("p",[t("code",[s._v("mysqladmin")]),s._v(" 支持以下选项，可以在命令行或选项文件的 "),t("code",[s._v("[mysqladmin]")]),s._v(" 和 "),t("code",[s._v("[client]")]),s._v(" 组中指定。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("--"),t("strong",[s._v("user")]),s._v("="),t("em",[s._v("user_name")]),s._v(", -"),t("strong",[s._v("u")]),s._v(" "),t("em",[s._v("user_name")])]),s._v(" "),t("p",[s._v("连接到服务器时使用的 MySQL 用户名。")])]),s._v(" "),t("li",[t("p",[s._v("--"),t("strong",[s._v("password")]),s._v("[="),t("em",[s._v("password")]),s._v("], -"),t("strong",[s._v("p")]),s._v("["),t("em",[s._v("password")]),s._v("]")]),s._v(" "),t("p",[s._v("连接到服务器时使用的密码。")])])]),s._v(" "),t("p",[t("code",[s._v("mysqladmin")]),s._v(" "),t("strong",[s._v("命令")]),s._v("：")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("flush-privileges")])]),s._v(" "),t("p",[s._v("重新加载授权表。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("password")]),s._v(" "),t("em",[s._v("new_password")])]),s._v(" "),t("p",[s._v("设置新密码。")])])]),s._v(" "),t("h3",{attrs:{id:"mysqldump"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysqldump"}},[s._v("#")]),s._v(" mysqldump")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/mysqldump.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("mysqldump")]),t("OutboundLink")],1),s._v(" 客户端执行逻辑备份，生成一组 SQL 语句，可以执行这些语句以重现原始数据库对象定义和表数据。")]),s._v(" "),t("p",[s._v("默认情况下，"),t("code",[s._v("mysqldump")]),s._v(" 将信息作为 SQL 语句写入标准输出，可以将输出保存在文件中。")]),s._v(" "),t("p",[s._v("要转储所有数据库，使用 "),t("code",[s._v("--all-databases")]),s._v(" 选项调用 "),t("code",[s._v("mysqldump")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("mysqldump --all-databases "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" dump.sql\n")])])]),t("p",[s._v("要仅转储特定数据库，使用 "),t("code",[s._v("--databases")]),s._v(" 选项。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("mysqldump "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--databases")]),s._v(" db1 db2 db3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" dump.sql\n")])])]),t("p",[s._v("要只转储数据库中的特定表，请在命令行中将这些表命名在数据库名称之后。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("mysqldump db1 t1 t3 t7 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" dump.sql\n")])])]),t("p",[s._v("要重新加载由 "),t("code",[s._v("mysqldump")]),s._v(" 编写的包含 SQL 语句的转储文件，请将其用作 "),t("code",[s._v("mysql")]),s._v(" 客户端的输入。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" dump.sql\n")])])]),t("p",[s._v("或者，从 "),t("code",[s._v("mysql")]),s._v(" 中使用 "),t("code",[s._v("source")]),s._v(" 命令。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" dump.sql\n")])])]),t("p",[t("code",[s._v("mysqldump")]),s._v(" "),t("strong",[s._v("选项")]),s._v("：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("--"),t("strong",[s._v("host")]),s._v("="),t("em",[s._v("host_name")]),s._v(", -"),t("strong",[s._v("h")]),s._v(" "),t("em",[s._v("host_name")])]),s._v(" "),t("p",[s._v("从给定主机上的 MySQL 服务器转储数据。")])]),s._v(" "),t("li",[t("p",[s._v("--"),t("strong",[s._v("password")]),s._v("[="),t("em",[s._v("password")]),s._v("], -"),t("strong",[s._v("p")]),s._v("["),t("em",[s._v("password")]),s._v("]")]),s._v(" "),t("p",[s._v("用于连接到服务器的 MySQL 帐户的密码。")])]),s._v(" "),t("li",[t("p",[s._v("--"),t("strong",[s._v("port")]),s._v("="),t("em",[s._v("port_num")]),s._v(", -"),t("strong",[s._v("P")]),s._v(" "),t("em",[s._v("port_num")])]),s._v(" "),t("p",[s._v("对于 TCP/IP 连接，要使用的端口号。")])])]),s._v(" "),t("h3",{attrs:{id:"mysqld"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysqld"}},[s._v("#")]),s._v(" mysqld")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/mysqld.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("mysqld")]),t("OutboundLink")],1),s._v("，也称为 MySQL Server。")]),s._v(" "),t("p",[t("code",[s._v("mysqld")]),s._v(" "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/server-options.html",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("选项")]),t("OutboundLink")],1),s._v("：")]),s._v(" "),t("p",[t("code",[s._v("mysqld")]),s._v(" 从"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/option-files.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("选项文件"),t("OutboundLink")],1),s._v("中的 "),t("code",[s._v("[mysqld]")]),s._v(" 和 "),t("code",[s._v("[server]")]),s._v(" 部分读取"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/server-options.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("所有选项"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("--"),t("strong",[s._v("skip-grant-tables")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("命令行格式："),t("code",[s._v("--skip-grant-tables[={OFF|ON}]")])])]),s._v(" "),t("li",[t("p",[s._v("默认值："),t("code",[s._v("OFF")])])])]),s._v(" "),t("p",[t("code",[s._v("--skip-grant-tables")]),s._v(" 会导致服务器不读取 "),t("code",[s._v("mysql")]),s._v(" 系统数据库中的授权表，因此不使用权限系统启动。这使任何有权访问服务器的人都可以不受限制地访问所有数据库。")])])]),s._v(" "),t("h2",{attrs:{id:"五、安全"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、安全"}},[s._v("#")]),s._v(" 五、安全")]),s._v(" "),t("h3",{attrs:{id:"密码验证插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#密码验证插件"}},[s._v("#")]),s._v(" 密码验证插件")]),s._v(" "),t("p",[s._v("密码验证插件系统变量：")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("validate_password_policy")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("命令行格式："),t("code",[s._v("--validate-password-policy=value")])])]),s._v(" "),t("li",[t("p",[s._v("默认值："),t("code",[s._v("1")])])]),s._v(" "),t("li",[t("p",[s._v("可选值："),t("code",[s._v("0")]),s._v(", "),t("code",[s._v("1")]),s._v(", "),t("code",[s._v("2")])])])]),s._v(" "),t("p",[s._v("由 "),t("em",[s._v("validate_password")]),s._v(" 强制执行的密码策略。除非安装了 "),t("em",[s._v("validate_password")]),s._v("，否则此变量不可用。")]),s._v(" "),t("p",[s._v("修改安全等级。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" @"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@validate_password_policy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v(" validate_password_policy "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])]),s._v(" "),t("h2",{attrs:{id:"六、数据类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六、数据类型"}},[s._v("#")]),s._v(" 六、数据类型")]),s._v(" "),t("h3",{attrs:{id:"字符串"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#字符串"}},[s._v("#")]),s._v(" 字符串")]),s._v(" "),t("p",[s._v("字符串数据类型为 "),t("code",[s._v("CHAR")]),s._v("、"),t("code",[s._v("VARCHAR")]),s._v("、"),t("code",[s._v("BINARY")]),s._v("、"),t("code",[s._v("VARBINARY")]),s._v("、"),t("code",[s._v("BLOB")]),s._v("、"),t("code",[s._v("TEXT")]),s._v("、"),t("code",[s._v("ENUM")]),s._v(" 和 "),t("code",[s._v("SET")]),s._v("。")]),s._v(" "),t("h4",{attrs:{id:"varchar"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#varchar"}},[s._v("#")]),s._v(" VARCHAR")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/char.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("VARCHAR")]),t("OutboundLink")],1),s._v(" 和 "),t("code",[s._v("CHAR")]),s._v(" 类型相似，但存储和检索方式不同，在最大长度和是否保留尾随空格方面也不同。")]),s._v(" "),t("p",[s._v("与 "),t("code",[s._v("CHAR")]),s._v(" 不同，"),t("code",[s._v("VARCHAR")]),s._v(" 值被存储为一个 "),t("code",[s._v("1")]),s._v(" 字节或 "),t("code",[s._v("2")]),s._v(" 字节的长度前缀加上数据，长度前缀表示值中的字节数。如果值不超过 255 字节，则列使用一个长度字节，如果值可能超过 255 字节，则使用两个长度字节。")]),s._v(" "),t("h4",{attrs:{id:"text"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#text"}},[s._v("#")]),s._v(" TEXT")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/blob.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("TEXT")]),t("OutboundLink")],1),s._v(" 是用来存储非常长的文本数据的类型，最大长度为 "),t("code",[s._v("65535")]),s._v(" 个字符。它存储的方式和 "),t("code",[s._v("VARCHAR")]),s._v(" 不同，会占用额外的存储空间。")]),s._v(" "),t("h4",{attrs:{id:"enum"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#enum"}},[s._v("#")]),s._v(" ENUM")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/enum.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("ENUM")]),t("OutboundLink")],1),s._v(" 是一个字符串对象，其值从允许的值列表中选择，这些值在表创建时在列规范中显式枚举。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" shirts "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    size "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'x-small'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'small'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'medium'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'large'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'x-large'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"日期"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日期"}},[s._v("#")]),s._v(" 日期")]),s._v(" "),t("p",[s._v("日期和时间数据类型有 "),t("code",[s._v("DATE")]),s._v("、"),t("code",[s._v("TIME")]),s._v("、"),t("code",[s._v("DATETIME")]),s._v("、"),t("code",[s._v("TIMESTAMP")]),s._v(" 和 "),t("code",[s._v("YEAR")]),s._v("。")]),s._v(" "),t("h4",{attrs:{id:"datetime"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#datetime"}},[s._v("#")]),s._v(" DATETIME")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/datetime.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("DATETIME")]),t("OutboundLink")],1),s._v(" 类型用于包含日期和时间部分的数值。")]),s._v(" "),t("p",[s._v("MySQL 以 "),t("code",[s._v("'YYYY-MM-DD hh:mm:ss'")]),s._v(" 格式检索和显示 "),t("code",[s._v("DATETIME")]),s._v(" 值，支持的范围是 "),t("code",[s._v("'1000-01-01 00:00:00'")]),s._v(" 到 "),t("code",[s._v("'9999-12-31 23:59:59'")]),s._v("。")]),s._v(" "),t("h4",{attrs:{id:"date"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#date"}},[s._v("#")]),s._v(" DATE")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/datetime.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("DATE")]),t("OutboundLink")],1),s._v(" 类型用于有日期部分但没有时间部分的值。")]),s._v(" "),t("p",[s._v("MySQL 检索并显示 "),t("code",[s._v("'YYYY-MM-DD'")]),s._v(" 格式的 "),t("code",[s._v("DATE")]),s._v(" 值，支持的范围为 "),t("code",[s._v("'1000-01-01'")]),s._v(" 到 "),t("code",[s._v("'9999-12-31'")]),s._v("。")]),s._v(" "),t("h4",{attrs:{id:"timestamp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#timestamp"}},[s._v("#")]),s._v(" TIMESTAMP")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/datetime.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("TIMESTAMP")]),t("OutboundLink")],1),s._v(" 数据类型用于同时包含日期和时间部分的值。")]),s._v(" "),t("p",[t("code",[s._v("TIMESTAMP")]),s._v(" 的范围为协调世界时 "),t("code",[s._v("1970-01-01 00:00:01")]),s._v(" 到协调世界时 "),t("code",[s._v("2038-01-19 03:14:07")]),s._v("。")]),s._v(" "),t("p",[s._v("MySQL 将 "),t("code",[s._v("TIMESTAMP")]),s._v(" 值从当前时区转换为 UTC 进行存储，并将其从 UTC 转换回当前时区进行检索。"),t("code",[s._v("DATETIME")]),s._v(" 不会发生这种情况。")]),s._v(" "),t("p",[s._v("默认情况下，每个连接的当前时区是服务器的时间，可以根据每个连接设置时区。")]),s._v(" "),t("h3",{attrs:{id:"数字"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数字"}},[s._v("#")]),s._v(" 数字")]),s._v(" "),t("h4",{attrs:{id:"integer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#integer"}},[s._v("#")]),s._v(" Integer")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/integer-types.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("整数"),t("OutboundLink")],1),s._v("类型。")]),s._v(" "),t("p",[t("code",[s._v("INT")]),s._v(" 为 4 字节 32 位有符号整数。")]),s._v(" "),t("h4",{attrs:{id:"boolean"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#boolean"}},[s._v("#")]),s._v(" BOOLEAN")]),s._v(" "),t("p",[t("code",[s._v("BOOLEAN")]),s._v(" 类型是 "),t("code",[s._v("TINYINT(1)")]),s._v(" 的同义词。零值被认为是 "),t("code",[s._v("false")]),s._v("，非零值被认为是 "),t("code",[s._v("true")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'true'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'false'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h4",{attrs:{id:"decimal"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#decimal"}},[s._v("#")]),s._v(" DECIMAL")]),s._v(" "),t("p",[s._v("在 "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/fixed-point-types.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("DECIMAL")]),t("OutboundLink")],1),s._v(" 列声明中，可以指定精度和小数位数。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("salary "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECIMAL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("标准 SQL 要求 "),t("code",[s._v("DECIMAL(5, 2)")]),s._v(" 能够存储任何具有五位数字和两位小数的值，因此可以存储在 "),t("em",[s._v("salary")]),s._v(" 列中的值范围为 "),t("code",[s._v("-999.99")]),s._v(" 到 "),t("code",[s._v("999.99")]),s._v("。")]),s._v(" "),t("h2",{attrs:{id:"七、函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#七、函数"}},[s._v("#")]),s._v(" 七、函数")]),s._v(" "),t("h3",{attrs:{id:"字符串-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#字符串-2"}},[s._v("#")]),s._v(" 字符串")]),s._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_right",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("RIGHT")]),t("OutboundLink")],1),s._v("("),t("em",[s._v("str")]),s._v(", "),t("em",[s._v("len")]),s._v(")")]),s._v(" "),t("p",[s._v("返回字符串 "),t("code",[s._v("str")]),s._v(" 中最右边的 "),t("code",[s._v("len")]),s._v(" 个字符。")])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_left",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("LEFT")]),t("OutboundLink")],1),s._v("("),t("em",[s._v("str")]),s._v(", "),t("em",[s._v("len")]),s._v(")")]),s._v(" "),t("p",[s._v("返回字符串 "),t("code",[s._v("str")]),s._v(" 中最左边的 "),t("code",[s._v("len")]),s._v(" 个字符。")])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_locate",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("LOCATE")]),t("OutboundLink")],1),s._v("("),t("em",[s._v("substr")]),s._v(", "),t("em",[s._v("str")]),s._v("), "),t("strong",[s._v("LOCATE")]),s._v("("),t("em",[s._v("substr")]),s._v(", "),t("em",[s._v("str")]),s._v(", "),t("em",[s._v("pos")]),s._v(")")]),s._v(" "),t("p",[s._v("第一种语法返回子字符串 "),t("code",[s._v("substr")]),s._v(" 在字符串 "),t("code",[s._v("str")]),s._v(" 中第一次出现的位置。")]),s._v(" "),t("p",[s._v("第二种语法返回子字符串 "),t("code",[s._v("substr")]),s._v(" 在字符串 "),t("code",[s._v("str")]),s._v(" 中第一次出现的位置，从位置 "),t("code",[s._v("pos")]),s._v(" 开始。")])])]),s._v(" "),t("h3",{attrs:{id:"聚合"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#聚合"}},[s._v("#")]),s._v(" 聚合")]),s._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/aggregate-functions.html#function_max",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("MAX")]),t("OutboundLink")],1),s._v("([DISTINCT] "),t("em",[s._v("expr")]),s._v(")")]),s._v(" "),t("p",[s._v("返回 "),t("code",[s._v("expr")]),s._v(" 的最大值。"),t("code",[s._v("MAX()")]),s._v(" 可以接受一个字符串参数；在这种情况下，它将返回最大的字符串值。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" modifyuser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("MAX")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("modifydate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" dispatchingorder "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" modifyuser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/aggregate-functions.html#function_sum",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("SUM")]),t("OutboundLink")],1),s._v("([DISTINCT] "),t("em",[s._v("expr")]),s._v(")")]),s._v(" "),t("p",[s._v("返回 "),t("code",[s._v("expr")]),s._v(" 的总和。如果返回集没有行，则 "),t("code",[s._v("SUM()")]),s._v(" 返回 "),t("code",[s._v("NULL")]),s._v("。"),t("code",[s._v("DISTINCT")]),s._v(" 关键字可用于仅对 "),t("code",[s._v("expr")]),s._v(" 的不同值求和。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" modifyuser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" dispatchingorder "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" modifyuser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])]),s._v(" "),t("h3",{attrs:{id:"日期和时间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日期和时间"}},[s._v("#")]),s._v(" 日期和时间")]),s._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/date-and-time-functions.html#function_date",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("DATE")]),t("OutboundLink")],1),s._v("("),t("em",[s._v("expr")]),s._v(")")]),s._v(" "),t("p",[s._v("提取日期或日期时间表达式 "),t("code",[s._v("expr")]),s._v(" 的日期部分。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2003-12-31 01:02:03'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])]),s._v(" "),t("h2",{attrs:{id:"八、运算符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#八、运算符"}},[s._v("#")]),s._v(" 八、运算符")]),s._v(" "),t("h3",{attrs:{id:"比较"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#比较"}},[s._v("#")]),s._v(" 比较")]),s._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/comparison-operators.html#operator_not-equal",target:"_blank",rel:"noopener noreferrer"}},[s._v("<>, !="),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("不等于。")])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/string-comparison-functions.html#operator_like",target:"_blank",rel:"noopener noreferrer"}},[s._v("LIKE"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("字符串简单模式匹配。")])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/string-comparison-functions.html#operator_not-like",target:"_blank",rel:"noopener noreferrer"}},[s._v("NOT LIKE"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("字符串简单模式匹配的否定。")])])]),s._v(" "),t("h3",{attrs:{id:"流程控制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#流程控制"}},[s._v("#")]),s._v(" 流程控制")]),s._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/flow-control-functions.html#function_if",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("IF")]),t("OutboundLink")],1),s._v("("),t("em",[s._v("expr1")]),s._v(", "),t("em",[s._v("expr2")]),s._v(", "),t("em",[s._v("expr3")]),s._v(")")]),s._v(" "),t("p",[s._v("如果 "),t("code",[s._v("expr1")]),s._v(" 为真，"),t("code",[s._v("IF()")]),s._v(" 返回 "),t("code",[s._v("expr2")]),s._v("。否则，它返回 "),t("code",[s._v("expr3")]),s._v("。")])])]),s._v(" "),t("h2",{attrs:{id:"九、日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#九、日志"}},[s._v("#")]),s._v(" 九、日志")]),s._v(" "),t("h3",{attrs:{id:"常规查询日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常规查询日志"}},[s._v("#")]),s._v(" 常规查询日志")]),s._v(" "),t("p",[s._v("常规查询日志是 "),t("code",[s._v("mysqld")]),s._v(" 正在进行的一般记录。当客户端连接或断开时，服务器会向该日志写入信息，并记录从客户端收到的每条 SQL 语句。")]),s._v(" "),t("p",[s._v("默认情况下，常规查询日志处于禁用状态。要明确指定初始的常规查询日志状态，可使用 "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_general_log",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("general_log")]),t("OutboundLink")],1),s._v("。要指定日志文件名，使用 "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_general_log_file",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("general_log_file")]),t("OutboundLink")],1),s._v("。要指定日志目的地，使用 "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_log_output",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("log_output")]),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("p",[s._v("启用常规查询日志：")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v(" general_log_file "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'general_log.log'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v(" general_log "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ON'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"十、存储引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十、存储引擎"}},[s._v("#")]),s._v(" 十、存储引擎")]),s._v(" "),t("h3",{attrs:{id:"myisam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#myisam"}},[s._v("#")]),s._v(" MyISAM")]),s._v(" "),t("h4",{attrs:{id:"自增列"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自增列"}},[s._v("#")]),s._v(" 自增列")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.4/en/myisam-storage-engine.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("MyISAM"),t("OutboundLink")],1),s._v(" 引擎支持"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.4/en/multiple-column-indexes.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("复合主键"),t("OutboundLink")],1),s._v("包含自增列，而 "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.4/en/innodb-storage-engine.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("InnoDB"),t("OutboundLink")],1),s._v(" 引擎不支持，因此 MyISAM 引擎"),t("a",{attrs:{href:"https://cloud.tencent.com/document/product/236/45043",target:"_blank",rel:"noopener noreferrer"}},[s._v("转换"),t("OutboundLink")],1),s._v("为 InnoDB 引擎后，创建表时会报错，报错信息为 "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.4/en/mysql-cluster-limitations-syntax.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("ERROR 1075"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("p",[s._v("MyISAM 允许自增列作为复合主键的非首列。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ec_pdf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("co"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ii"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bigint")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("co"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ii"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- MyISAM允许自增列作为复合主键的非首列")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("MyISAM "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARSET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("InnoDB 中，自增列必须是键。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ec_pdf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("co"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ii"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bigint")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("co"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ii"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- MyISAM允许自增列作为复合主键的非首列")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ii"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ii"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 为自增列创建索引")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("InnoDB")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARSET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("如果是复合主键，应位于复合主键的首位。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ec_pdf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("co"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ii"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bigint")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("ii"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token identifier"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("co"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 自增列作为主键首列")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("InnoDB")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARSET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[t("strong",[s._v("原始数据分析：")])]),s._v(" "),t("p",[s._v("查询原始文件有多少自增参数。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"AUTO_INCREMENT"')]),s._v(" data.sql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/ENGINE=MyISAM/ENGINE=InnoDB/g'")]),s._v(" data.sql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n  BEGIN { RS=";"; ORS=";"; FS="\\n"; OFS="\\n"; count=0 }\n  {\n    for (i = 1; i <= NF; i++) {  # 遍历每个字段（即行）\n      while ($i ~ /AUTO_INCREMENT/) {  # 如果当前字段包含 AUTO_INCREMENT\n        sub(/AUTO_INCREMENT/, "", $i); # 移除第一个匹配项，避免无限循环\n        count++;  # 递增计数\n      }\n    }\n  }\n  END { print count }\'')]),s._v("\n")])])]),t("p",[s._v("查询原始文件中，有多少包含自增参数的行（一行可能包含多个自增参数，避免重复统计）。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"AUTO_INCREMENT"')]),s._v(" data.sql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/ENGINE=MyISAM/ENGINE=InnoDB/g'")]),s._v(" data.sql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n  BEGIN { RS=";"; ORS=";"; FS="\\n"; OFS="\\n"; count=0 }\n  {\n    for (i = 1; i <= NF; i++) {  # 遍历每个字段（即行）\n      if ($i ~ /AUTO_INCREMENT/)  # 如果当前字段包含 AUTO_INCREMENT\n        count++;  # 递增计数\n    }\n  }\n  END { print count }\'')]),s._v("\n")])])]),t("p",[s._v("查询原始文件中，有多少包含自增参数的 SQL 语句。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'BEGIN { RS=";"; IGNORECASE=1 }\n{\n  gsub(/\\n/, " ", $0);\n  if ($0 ~ /CREATE[[:space:]]+TABLE/ && $0 ~ /AUTO_INCREMENT/)\n    count++\n}\nEND { print count }\'')]),s._v(" data.sql\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/ENGINE=MyISAM/ENGINE=InnoDB/g'")]),s._v(" data.sql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n  BEGIN { RS=";"; ORS=";"; FS="\\n" }\n  $0 ~ /CREATE TABLE/ && $0 ~ /AUTO_INCREMENT/ { count++ }\n  END { print count }\'')]),s._v("\n")])])]),t("p",[s._v("查询原始文件中，有多少包含自增参数，且包含复合主键的 SQL 语句（匹配 "),t("code",[s._v("PRIMARY KEY")]),s._v("，且括号内至少一个逗号，以确保主键包含两个或更多字段）。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'BEGIN { RS=";"; FS="\\n"; IGNORECASE=1 }\n{\n  if ($0 ~ /CREATE[[:space:]]+TABLE/ && $0 ~ /AUTO_INCREMENT/ && $0 ~ /PRIMARY[[:space:]]+KEY[[:space:]]*\\([^)]*,[^)]*\\)/)\n    count++\n}\nEND { print count }\'')]),s._v(" data.sql\n")])])]),t("p",[s._v("查询需要修改的语句数量（自增列作为复合主键的非首列）。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'BEGIN { RS = ";"; IGNORECASE = 1 }\n{\n    if ($0 ~ /CREATE[[:space:]]+TABLE/ && $0 ~ /AUTO_INCREMENT/) {\n        pk_match = match($0, /PRIMARY[[:space:]]+KEY[[:space:]]*\\([^)]+\\)/);\n        if (pk_match) {\n            pk_def = substr($0, RSTART, RLENGTH);  # 提取主键定义\n\n            # 提取主键字段列表\n            split(pk_def, arr, /[(),]/);\n            first_pk_field = arr[2];\n\n            # 检查自增列是否为首字段\n            if ($0 !~ first_pk_field"[^,]*AUTO_INCREMENT") {\n                count++;\n            }\n        }\n    }\n}\nEND { print count }\'')]),s._v(" data.sql\n")])])]),t("p",[s._v("通过命令修改 SQL 语句，让自增列作为复合主键的首列（"),t("code",[s._v("gawk")]),s._v(" 版本）。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/ENGINE=MyISAM/ENGINE=InnoDB/g'")]),s._v(" data.sql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\nBEGIN { RS = ";"; ORS = ";" }\n{\n    if ($0 ~ /CREATE[[:space:]]+TABLE/ && $0 ~ /AUTO_INCREMENT/) {\n        ai_col = "";\n        pk_fields = "";\n        \n        # 提取自增列名\n        if (match($0, /`([^`]+)`[^,`]*AUTO_INCREMENT/, m))\n            ai_col = m[1]\n    \n        # 提取主键字段列表\n        if (match($0, /PRIMARY[[:space:]]+KEY[[:space:]]*\\(([^)]+)\\)/, pk)) {\n            split(pk[1], arr, /,[[:space:]]*/)\n            # 清洗字段名并检查顺序\n            new_pk = ""\n            for (i=1; i<=length(arr); i++) {\n                gsub(/[`[:space:]]/, "", arr[i])  # 去除反引号和空格\n                if (arr[i] == ai_col && new_pk == "") {\n                    new_pk = ai_col  # 自增列置顶\n                } else if (arr[i] != ai_col) {\n                    pk_fields = (pk_fields == "" ? arr[i] : pk_fields "," arr[i])\n                }\n            }\n            # 重组主键（仅当需要调整时）\n            if (ai_col != "" && arr[1] != ai_col && new_pk != "") {\n                new_pk = "PRIMARY KEY (`" ai_col "`" (pk_fields != "" ? ",`" pk_fields "`" : "") ")";\n                gsub(/,/, "`,`", new_pk)  # 处理字段分隔符\n                sub(/PRIMARY[[:space:]]+KEY[[:space:]]*\\([^)]+\\)/, new_pk, $0)\n            }\n        }\n    }\n    print $0\n}\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/PRIMARY KEY/s/``,``/`,`/g'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修复异常替换")]),s._v("\n")])])]),t("p",[t("a",{attrs:{href:"https://invisible-island.net/mawk/",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("mawk")]),t("OutboundLink")],1),s._v(" 版本不支持 "),t("code",[s._v("match()")]),s._v(" 函数的第三个参数（捕获组数组）。请使用以下兼容性改写方案：")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/ENGINE=MyISAM/ENGINE=InnoDB/g'")]),s._v(" data.sql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mawk "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\nBEGIN {\n    RS = ";\\n*";\n    ORS = ";\\n";\n    IGNORECASE = 1\n}\n{\n    if ($0 ~ /CREATE[[:space:]]+TABLE/ && $0 ~ /AUTO_INCREMENT/) {\n        ai_col = ""; pk_fields = ""\n        # 兼容性提取自增列名\n        if (match($0, /`[^`]+`[^,`]*AUTO_INCREMENT/)) {\n            col_part = substr($0, RSTART, RLENGTH)\n            ai_col = substr(col_part, 2, index(col_part, "` ")-2)\n        }\n        \n        # 提取主键字段（兼容写法）\n        if (match($0, /PRIMARY[[:space:]]+KEY[[:space:]]*\\([^)]+\\)/)) {\n            pk_start = RSTART\n            pk_end = RSTART + RLENGTH\n            pk_str = substr($0, pk_start+13, pk_end - pk_start - 14)\n            gsub(/[`[:space:]]/, "", pk_str)  # 清理特殊字符\n            split(pk_str, pk_arr, ",")\n            \n            # 重组主键顺序\n            if (ai_col != "" && pk_arr[1] != ai_col) {\n                new_pk = ai_col\n                for (i=1; i<=length(pk_arr); i++) {\n                    if (pk_arr[i] != ai_col) \n                        new_pk = new_pk "," pk_arr[i]\n                }\n                # 替换主键定义\n                sub(/PRIMARY[[:space:]]+KEY[[:space:]]*\\([^)]+\\)/,\n                    "PRIMARY KEY (`" gensub(/,/, "`,`", "g", new_pk) "`)", $0)\n            }\n        }\n    }\n    print $0\n}\'')]),s._v("\n")])])]),t("p",[s._v("通过 "),t("a",{attrs:{href:"https://www.gnu.org/software/gawk/manual/html_node/String-Functions.html#index-gensub_0028_0029-function-_0028gawk_0029-1",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("gensub")]),t("OutboundLink")],1),s._v(" 函数保持字段反引号的规范性，"),t("a",{attrs:{href:"https://www.gnu.org/software/gawk/manual/html_node/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("GNU awk"),t("OutboundLink")],1),s._v(" 支持，如使用其他版本可替换为 "),t("a",{attrs:{href:"https://www.gnu.org/software/gawk/manual/html_node/String-Functions.html#index-gsub_0028_0029-function-1",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("gsub")]),t("OutboundLink")],1),s._v(" 链。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/ENGINE=MyISAM/ENGINE=InnoDB/g'")]),s._v(" data.sql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mawk "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\nBEGIN {\n    RS = ";\\n*";\n    ORS = ";\\n";\n    IGNORECASE = 1\n}\n{\n    if ($0 ~ /CREATE[[:space:]]+TABLE/ && $0 ~ /AUTO_INCREMENT/) {\n        ai_col = ""; pk_fields = ""\n        # 兼容性提取自增列名\n        if (match($0, /`[^`]+`[^,`]*AUTO_INCREMENT/)) {\n            col_part = substr($0, RSTART, RLENGTH)\n            ai_col = substr(col_part, 2, index(col_part, "` ")-2)\n        }\n        \n        # 提取主键字段（兼容写法）\n        if (match($0, /PRIMARY[[:space:]]+KEY[[:space:]]*\\([^)]+\\)/)) {\n            pk_start = RSTART\n            pk_end = RSTART + RLENGTH\n            pk_str = substr($0, pk_start+13, pk_end - pk_start - 14)\n            gsub(/[`[:space:]]/, "", pk_str)  # 清理特殊字符\n            split(pk_str, pk_arr, ",")\n            \n            # 重组主键顺序\n            if (ai_col != "" && pk_arr[1] != ai_col) {\n                new_pk = ai_col\n                for (i=1; i<=length(pk_arr); i++) {\n                    if (pk_arr[i] != ai_col) \n                        new_pk = new_pk "," pk_arr[i]\n                }\n                # 替换主键定义（用 gsub 替代 gensub）\n                temp_pk = new_pk               # 创建临时变量\n                gsub(/,/, "`,`", temp_pk)      # 直接修改临时变量\n                sub(/PRIMARY[[:space:]]+KEY[[:space:]]*\\([^)]+\\)/,\n                    "PRIMARY KEY (`" temp_pk "`)", $0)  # 使用修改后的变量\n            }\n        }\n    }\n    print $0\n}\'')]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);