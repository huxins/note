(window.webpackJsonp=window.webpackJsonp||[]).push([[244],{556:function(t,s,e){"use strict";e.r(s);var n=e(27),a=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[t._v("#")]),t._v(" Nginx")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://nginx.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx"),s("OutboundLink")],1),t._v(" 是一个高性能的 HTTP 和反向代理服务器，广泛用于 Web 服务器、负载均衡、反向代理和 HTTP 缓存等多种场景。")]),t._v(" "),s("h2",{attrs:{id:"一、安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、安装"}},[t._v("#")]),t._v(" 一、安装")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("CentOS")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-ivh")]),t._v(" http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\nyum info nginx\nyum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" nginx\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"二、模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、模块"}},[t._v("#")]),t._v(" 二、模块")]),t._v(" "),s("h3",{attrs:{id:"ngx-http-core-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ngx-http-core-module"}},[t._v("#")]),t._v(" ngx_http_core_module")]),t._v(" "),s("p",[s("strong",[t._v("嵌入式变量：")])]),t._v(" "),s("ul",[s("li",[t._v("$"),s("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_core_module.html#var_http_",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("http")]),s("OutboundLink")],1),t._v("_"),s("em",[t._v("name")]),t._v("：任意请求头字段；变量名的最后一部分是转换为小写的字段名，用下划线替换短划线。例如，"),s("em",[t._v("$http_host")]),t._v(" 代表 "),s("em",[t._v("host")]),t._v(" 请求头。")])]),t._v(" "),s("h3",{attrs:{id:"ngx-http-ssl-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ngx-http-ssl-module"}},[t._v("#")]),t._v(" ngx_http_ssl_module")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_ssl_module.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("ngx_http_ssl_module")]),s("OutboundLink")],1),t._v(" 模块为 HTTPS 提供了必要的支持。")]),t._v(" "),s("p",[t._v("此模块不是默认构建的，应使用 "),s("code",[t._v("--with-http_ssl_module")]),t._v(" 配置参数启用。")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_session_cache",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("ssl_session_cache")]),s("OutboundLink")],1),t._v("：设置存储会话参数的缓存的类型和大小。")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_session_timeout",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("ssl_session_timeout")]),s("OutboundLink")],1),t._v("：指定客户端可以重用会话参数的时间。")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_certificate",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("ssl_certificate")]),s("OutboundLink")],1),t._v("：为给定的虚拟服务器指定具有 PEM 格式证书的文件。")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_ciphers",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("ssl_ciphers")]),s("OutboundLink")],1),t._v("：指定启用的密码。密码以 OpenSSL 库所理解的格式指定。")])]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_session_cache")]),t._v("   shared:SSL:10m")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_session_timeout")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10m")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v(" ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("         www.example.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("keepalive_timeout")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("70")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate")]),t._v("     www.example.com.crt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate_key")]),t._v(" www.example.com.key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_protocols")]),t._v("       TLSv1 TLSv1.1 TLSv1.2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_ciphers")]),t._v("         HIGH:!aNULL:!MD5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"ngx-http-proxy-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ngx-http-proxy-module"}},[t._v("#")]),t._v(" ngx_http_proxy_module")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_proxy_module.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("ngx_http_proxy_module")]),s("OutboundLink")],1),t._v(" 模块允许将请求传递到另一台服务器。")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("proxy_pass")]),s("OutboundLink")],1),t._v("：设置代理服务器的协议和地址。")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_set_header",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("proxy_set_header")]),s("OutboundLink")],1),t._v("：允许在传递给代理服务器的请求标头中重新定义或附加字段。")])]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" https://1.0.0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" Host "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_ssl_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_ssl_server_name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Real-IP "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Forwarded-For "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("如果 "),s("code",[t._v("proxy_pass")]),t._v(" 指令是用 "),s("em",[t._v("URI")]),t._v(" 指定的，那么当请求传递到服务器时，请求 "),s("em",[t._v("URI")]),t._v(" 中与 "),s("code",[t._v("location")]),t._v(" 匹配的部分将被 "),s("code",[t._v("proxy_pass")]),t._v(" 指令中指定的 "),s("em",[t._v("URI")]),t._v(" 替换。")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http://www.wandouduoduo.com/wddd/index.html")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http://127.0.0.1:8080/index.html")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /wddd/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:8080/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http://127.0.0.1:8080/sun/index.html")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /wddd/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:8080/sun/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http://127.0.0.1:8080/sunindex.html")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /wddd/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:8080/sun")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("如果指定 "),s("code",[t._v("proxy_pass")]),t._v(" 时没有 "),s("em",[t._v("URI")]),t._v("，则在处理原始请求时，请求 "),s("em",[t._v("URI")]),t._v(" 将以客户端发送的相同形式传递给服务器。")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http://www.wandouduoduo.com/wddd/index.html")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http://127.0.0.1:8080/wddd/index.html")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /wddd/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://127.0.0.1:8080")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=a.exports}}]);