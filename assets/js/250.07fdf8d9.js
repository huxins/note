(window.webpackJsonp=window.webpackJsonp||[]).push([[250],{563:function(e,r,t){"use strict";t.r(r);var a=t(27),s=Object(a.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"docker"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[e._v("#")]),e._v(" Docker")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker"),r("OutboundLink")],1),e._v(" 是一个开源的应用容器化平台，用于开发、打包和运行应用程序。它通过容器技术，将应用及其依赖打包在一起，确保在任何环境中都能一致地运行。")]),e._v(" "),r("h2",{attrs:{id:"一、安装"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#一、安装"}},[e._v("#")]),e._v(" 一、安装")]),e._v(" "),r("ul",[r("li",[r("p",[r("strong",[e._v("Debian")])]),e._v(" "),r("p",[e._v("使用"),r("a",{attrs:{href:"https://docs.docker.com/engine/install/debian/#install-using-the-convenience-script",target:"_blank",rel:"noopener noreferrer"}},[e._v("脚本"),r("OutboundLink")],1),e._v("快速安装。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-fsSL")]),e._v(" https://get.docker.com "),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("bash")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-s")]),e._v(" -- "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--mirror")]),e._v(" Aliyun\n")])])])])]),e._v(" "),r("p",[e._v("默认情况下，"),r("code",[e._v("docker")]),e._v(" 命令会使用 Unix socket 与 Docker 引擎通讯，而只有 "),r("code",[e._v("root")]),e._v(" 用户和 "),r("code",[e._v("docker")]),e._v(" 组的用户才可以访问 Docker 引擎的 Unix socket。")]),e._v(" "),r("p",[e._v("出于安全考虑，一般 Linux 系统上不会直接使用 "),r("code",[e._v("root")]),e._v(" 用户。因此，更好地做法是将需要使用 "),r("code",[e._v("docker")]),e._v(" 的用户加入 "),r("code",[e._v("docker")]),e._v(" 用户组。")]),e._v(" "),r("p",[e._v("正常情况下，快速脚本已经建立了 "),r("code",[e._v("docker")]),e._v(" 组，如果未建立，可以手动创建 "),r("code",[e._v("docker")]),e._v(" 组。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("groupadd")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v("\n")])])]),r("p",[e._v("将当前用户或指定用户加入 "),r("code",[e._v("docker")]),e._v(" 组。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("usermod")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-aG")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$USER")]),e._v("\n")])])]),r("h2",{attrs:{id:"二、镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#二、镜像"}},[e._v("#")]),e._v(" 二、镜像")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/image/",target:"_blank",rel:"noopener noreferrer"}},[e._v("镜像"),r("OutboundLink")],1),e._v("是容器的蓝图，包含了应用及其依赖的文件系统，镜像一旦创建可以在不同的机器上启动容器。可以通过 "),r("a",{attrs:{href:"https://docs.docker.com/reference/dockerfile/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dockerfile"),r("OutboundLink")],1),e._v(" 定义镜像的构建过程。")]),e._v(" "),r("h3",{attrs:{id:"获取镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#获取镜像"}},[e._v("#")]),e._v(" 获取镜像")]),e._v(" "),r("p",[e._v("从 Docker 镜像仓库获取镜像的命令是 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/image/pull/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker pull")]),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" pull alpine:3.13\n")])])]),r("h3",{attrs:{id:"列出镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#列出镜像"}},[e._v("#")]),e._v(" 列出镜像")]),e._v(" "),r("p",[e._v("要想列出已经下载下来的镜像，可以使用 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/image/ls/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker image ls")]),r("OutboundLink")],1),e._v(" 命令。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" image "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("ls")]),e._v("\n")])])]),r("h2",{attrs:{id:"三、容器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#三、容器"}},[e._v("#")]),e._v(" 三、容器")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/",target:"_blank",rel:"noopener noreferrer"}},[e._v("容器"),r("OutboundLink")],1),e._v("是 Docker 中的基本执行单元，是一种轻量级、可移植的环境，允许开发者将应用及其依赖打包到一个容器中。容器是隔离的，确保应用能够在不同机器、环境间无缝迁移和运行。")]),e._v(" "),r("h3",{attrs:{id:"启动容器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[e._v("#")]),e._v(" 启动容器")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/run/",target:"_blank",rel:"noopener noreferrer"}},[e._v("启动容器"),r("OutboundLink")],1),e._v("有两种方式，一种是基于镜像新建一个容器并启动，另外一个是将在终止状态的容器重新启动。")]),e._v(" "),r("ul",[r("li",[e._v("--"),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/run/#restart",target:"_blank",rel:"noopener noreferrer"}},[r("strong",[e._v("restart")]),r("OutboundLink")],1),e._v(" "),r("em",[e._v("policy")]),e._v("：使用 "),r("code",[e._v("--restart")]),e._v(" 标志可以指定容器的重新启动策略。支持以下重启策略："),r("code",[e._v("always")]),e._v("。")]),e._v(" "),r("li",[e._v("-"),r("strong",[e._v("i")]),e._v("：保持容器的 STDIN 打开，并允许通过标准输入向容器发送输入。")]),e._v(" "),r("li",[e._v("-"),r("strong",[e._v("t")]),e._v("：将一个伪 tty 附加到容器。")]),e._v(" "),r("li",[e._v("--"),r("strong",[e._v("entrypoint")]),e._v(" "),r("em",[e._v("cmd")]),e._v("：覆盖 "),r("em",[e._v("image")]),e._v(" 的默认 "),r("em",[e._v("ENTRYPOINT")]),e._v("。")])]),e._v(" "),r("p",[e._v("新建并启动一个容器，输出一个 "),r("em",[e._v("Hello World")]),e._v("。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" run alpine:3.13 /bin/echo "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Hello world'")]),e._v("\n")])])]),r("p",[e._v("启动一个 "),r("code",[e._v("sh")]),e._v(" 终端，允许用户进行交互。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" run "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-t")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" alpine:3.13 /bin/sh\n")])])]),r("p",[e._v("已启动的容器，可以使用 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/update/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker update")]),r("OutboundLink")],1),e._v(" 命令动态更新容器配置。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" update "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--restart")]),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("always abebf7571666\n")])])]),r("p",[e._v("如果 Docker 镜像 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/run/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("run")]),r("OutboundLink")],1),e._v(" 失败了，可以在启动容器时设置 "),r("a",{attrs:{href:"https://docs.docker.com/engine/containers/run/#default-entrypoint",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("--entrypoint")]),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" run "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--rm")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-it")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--entrypoint")]),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/bin/sh image-name\n")])])]),r("p",[e._v("遇到问题需要排查时，可以通过 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/inspect/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker inspect")]),r("OutboundLink")],1),e._v(" 来获取容器的日志地址。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" inspect "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--format")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v("'{{.LogPath}}'")]),e._v(" 97069f94437b\n")])])]),r("p",[e._v("还可以使用 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/logs/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker logs")]),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" logs 97069f94437b\n")])])]),r("h3",{attrs:{id:"进入容器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#进入容器"}},[e._v("#")]),e._v(" 进入容器")]),e._v(" "),r("p",[e._v("在使用 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/run/#detach",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("-d")]),r("OutboundLink")],1),e._v(" 参数时，容器启动后会进入后台。")]),e._v(" "),r("p",[e._v("某些时候需要进入容器进行操作，可以使用 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/attach/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker attach")]),r("OutboundLink")],1),e._v(" 命令或 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/exec/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker exec")]),r("OutboundLink")],1),e._v(" 命令。")]),e._v(" "),r("ul",[r("li",[r("p",[e._v("docker "),r("strong",[e._v("attach")])]),e._v(" "),r("p",[r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/attach/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker attach")]),r("OutboundLink")],1),e._v(" 可以使用容器的 ID 或名称将终端的标准输入、输出和错误附加到正在运行的容器。这使您能够以交互方式查看其输出或控制它，就好像命令直接在终端中运行一样。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" run "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-dit")]),e._v(" ubuntu\n"),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" attach 243c\n")])])]),r("p",[e._v("如果从这个 "),r("code",[e._v("stdin")]),e._v(" 中 "),r("code",[e._v("exit")]),e._v("，会导致容器的停止。")])]),e._v(" "),r("li",[r("p",[e._v("docker "),r("strong",[e._v("exec")])]),e._v(" "),r("p",[r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/exec/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker exec")]),r("OutboundLink")],1),e._v(" 后边可以跟多个参数，当 "),r("code",[e._v("-i")]),e._v(" 和 "),r("code",[e._v("-t")]),e._v(" 参数一起使用时，则可以看到我们熟悉的 Linux 命令提示符。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" run "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-dit")]),e._v(" ubuntu\n"),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exec")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-it")]),e._v(" 69d1 "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("bash")]),e._v("\n")])])]),r("p",[e._v("如果从这个 "),r("code",[e._v("stdin")]),e._v(" 中 "),r("code",[e._v("exit")]),e._v("，不会导致容器的停止。")])])]),e._v(" "),r("h3",{attrs:{id:"导入导出"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#导入导出"}},[e._v("#")]),e._v(" 导入导出")]),e._v(" "),r("p",[e._v("如果要导出本地某个容器，可以使用 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/container/export/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker export")]),r("OutboundLink")],1),e._v(" 命令。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" 7691a814370e "),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" ubuntu.tar\n")])])]),r("p",[e._v("可以使用 "),r("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/image/import/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("docker import")]),r("OutboundLink")],1),e._v(" 从容器快照文件中再导入为镜像。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" ubuntu.tar "),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("import")]),e._v(" - test/ubuntu:v1.0\n")])])]),r("p",[e._v("也可以通过指定 URL 或者某个目录来导入。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("import")]),e._v(" http://example.com/exampleimage.tgz example/imagerepo\n")])])])])}),[],!1,null,null,null);r.default=s.exports}}]);