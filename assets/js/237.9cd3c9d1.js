(window.webpackJsonp=window.webpackJsonp||[]).push([[237],{550:function(t,a,s){"use strict";s.r(a);var e=s(27),v=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"util-linux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#util-linux"}},[t._v("#")]),t._v(" util-linux")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://packages.debian.org/sid/util-linux",target:"_blank",rel:"noopener noreferrer"}},[t._v("util-linux"),a("OutboundLink")],1),t._v(" 提供了许多重要的工具，大部分面向系统维护。这些工具能查看内核信息、创建新的文件系统、查看块设备信息以及提供与实时时钟交互的接口等等。")]),t._v(" "),a("h2",{attrs:{id:"一、存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、存储"}},[t._v("#")]),t._v(" 一、存储")]),t._v(" "),a("h3",{attrs:{id:"lsblk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsblk"}},[t._v("#")]),t._v(" lsblk")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://manpages.debian.org/bookworm/util-linux/lsblk.8.en.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("lsblk")]),a("OutboundLink")],1),t._v(" 列出有关所有可用或指定块设备的信息。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("lsblk\n")])])]),a("p",[t._v("查看 "),a("a",{attrs:{href:"https://wiki.debian.org/udev",target:"_blank",rel:"noopener noreferrer"}},[t._v("Udev"),a("OutboundLink")],1),t._v(" 生成的"),a("a",{attrs:{href:"https://wiki.debian.org/Persistent_disk_names",target:"_blank",rel:"noopener noreferrer"}},[t._v("符号链接"),a("OutboundLink")],1),t._v("目录。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("/dev/disk/by-id/")]),t._v("：设备的 ID 可能基于硬件序列号（如 "),a("code",[t._v("wwn-")]),t._v("）、制造商信息、连接接口（如 "),a("code",[t._v("usb-")]),t._v("），适用于唯一标识物理设备。")]),t._v(" "),a("li",[a("code",[t._v("/dev/disk/by-uuid/")]),t._v("：设备的 UUID 是文件系统级别的唯一标识，每次格式化时都会重新生成，适用于唯一标识文件系统。")]),t._v(" "),a("li",[a("code",[t._v("/dev/disk/by-partlabel/")]),t._v("：基于分区标签（Partition Label）生成的符号链接，它的作用是为磁盘分区提供一个更具可读性的名称。")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),t._v(" /dev/disk/by-id/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("column")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),t._v(" /dev/disk/by-uuid/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("column")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),t._v(" /dev/disk/by-partlabel/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("column")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v("\n")])])]),a("p",[t._v("查看磁盘虚拟化驱动。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("lsmod "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-oE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'virtio_scsi|virtio_blk'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("head")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-1")]),t._v("\n")])])]),a("h3",{attrs:{id:"fdisk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fdisk"}},[t._v("#")]),t._v(" fdisk")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://man7.org/linux/man-pages/man8/fdisk.8.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("fdisk")]),a("OutboundLink")],1),t._v(" 提供了为定义文件系统准备的磁盘分区功能。")]),t._v(" "),a("p",[a("strong",[t._v("命令行选项")]),t._v("：")]),t._v(" "),a("ul",[a("li",[t._v("-"),a("strong",[t._v("b")]),t._v(" "),a("em",[t._v("sectorsize")]),t._v("：指定磁盘的扇区大小。有效值为 "),a("code",[t._v("512")]),t._v("、"),a("code",[t._v("1024")]),t._v("、"),a("code",[t._v("2048")]),t._v(" 或 "),a("code",[t._v("4096")]),t._v("。")]),t._v(" "),a("li",[t._v("-"),a("strong",[t._v("C")]),t._v(" "),a("em",[t._v("cyls")]),t._v("：指定磁盘的柱面数。")]),t._v(" "),a("li",[t._v("-"),a("strong",[t._v("H")]),t._v(" "),a("em",[t._v("heads")]),t._v("：指定磁盘的磁头数。")]),t._v(" "),a("li",[t._v("-"),a("strong",[t._v("S")]),t._v(" "),a("em",[t._v("sects")]),t._v("：指定磁盘每个磁道的扇区数。")]),t._v(" "),a("li",[t._v("-"),a("strong",[t._v("c")]),t._v("：关闭 DOS 兼容模式。")]),t._v(" "),a("li",[t._v("-"),a("strong",[t._v("l")]),t._v("：列出指定设备的分区表。如果没有给出设备，则使用 "),a("code",[t._v("/proc/partitions")]),t._v(" 中提到的那些。")]),t._v(" "),a("li",[t._v("-"),a("strong",[t._v("u")]),t._v("：列出分区表时，以扇区而不是柱面给出大小。")])]),t._v(" "),a("p",[a("strong",[t._v("用法")]),t._v("：")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://tldp.org/HOWTO/html_single/Partition/#fdisk_partitioning",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("fdisk")]),a("OutboundLink")],1),t._v(" 通过在命令提示符下键入 "),a("code",[t._v("fdisk device")]),t._v(" 来启动。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fdisk")]),t._v(" /dev/vdb\n")])])]),a("ul",[a("li",[t._v("输入 "),a("strong",[a("code",[t._v("p")])]),t._v(" 打印分区表。")]),t._v(" "),a("li",[t._v("输入 "),a("strong",[a("code",[t._v("n")])]),t._v(" 创建一个新分区。")]),t._v(" "),a("li",[t._v("输入 "),a("strong",[a("code",[t._v("w")])]),t._v(" 写入新的分区表并退出。")]),t._v(" "),a("li",[t._v("输入 "),a("strong",[a("code",[t._v("d")])]),t._v(" 删除分区。")]),t._v(" "),a("li",[t._v("输入 "),a("strong",[a("code",[t._v("t")])]),t._v(" 更改分区类型。")]),t._v(" "),a("li",[t._v("输入 "),a("strong",[a("code",[t._v("q")])]),t._v(" 退出而不保存更改。")])]),t._v(" "),a("h3",{attrs:{id:"mkfs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mkfs"}},[t._v("#")]),t._v(" mkfs")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://man7.org/linux/man-pages/man8/mkfs.8.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("mkfs")]),a("OutboundLink")],1),t._v(" 是用于格式化具有特定文件系统的块存储设备的命令。")]),t._v(" "),a("p",[a("code",[t._v("mkfs")]),t._v(" 是一个通用命令，用于创建文件系统。它是一个前端工具，可以调用具体的文件系统创建程序。")]),t._v(" "),a("p",[a("strong",[t._v("命令行选项")]),t._v("：")]),t._v(" "),a("ul",[a("li",[t._v("-"),a("strong",[t._v("t")]),t._v(" "),a("em",[t._v("type")]),t._v("：指定要构建的文件系统的类型。如果未指定，则使用默认文件系统类型（当前为 "),a("code",[t._v("ext2")]),t._v("）。")])]),t._v(" "),a("p",[t._v("例如，创建一个 "),a("code",[t._v("ext4")]),t._v(" 文件系统，实际调用的程序可能是 "),a("code",[t._v("mke2fs")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkfs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" ext4 /dev/vdb1\n")])])]),a("p",[a("code",[t._v("mkfs.ext4")]),t._v("、"),a("code",[t._v("mkfs.ext3")]),t._v("、"),a("code",[t._v("mkfs.ext2")]),t._v(" 实际上是 "),a("code",[t._v("mke2fs")]),t._v(" 的不同调用方式。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mke2fs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" ext4 /dev/vdb1\n")])])]),a("h3",{attrs:{id:"mount"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mount"}},[t._v("#")]),t._v(" mount")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://man7.org/linux/man-pages/man8/mount.8.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("mount")]),a("OutboundLink")],1),t._v(" 用于挂载文件系统。")]),t._v(" "),a("p",[t._v("传统 "),a("code",[t._v("mount")]),t._v(" 需要 "),a("code",[t._v("root")]),t._v(" 权限，但现在支持 "),a("code",[t._v("sudo")]),t._v(" 或者 "),a("code",[t._v("/etc/fstab")]),t._v(" 中的 "),a("code",[t._v("user")]),t._v(" 选项，使普通用户可以挂载特定设备。")]),t._v(" "),a("p",[a("code",[t._v("systemd")]),t._v(" 也引入了 "),a("code",[t._v("automount")]),t._v(" 功能，提供自动挂载功能，减少手动干预。")]),t._v(" "),a("p",[a("strong",[t._v("命令行选项")]),t._v("：")]),t._v(" "),a("ul",[a("li",[t._v("-"),a("strong",[t._v("t")]),t._v(" "),a("em",[t._v("fstype")]),t._v("：指示文件系统类型。")]),t._v(" "),a("li",[t._v("-"),a("strong",[t._v("a")]),t._v("：挂载 "),a("code",[t._v("fstab")]),t._v(" 中提到的所有文件系统（给定类型）（行中包含 "),a("code",[t._v("noauto")]),t._v(" 关键字的除外）。")])]),t._v(" "),a("p",[t._v("查看当前已挂载的文件系统。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("column")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /proc/mounts "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("column")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v("\n")])])]),a("p",[t._v("将硬盘驱动器的第一个分区挂载到现有目录。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" ext4 /dev/vdb1 /media/data\n")])])]),a("p",[t._v("参考物理磁盘分区卸载。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("umount")]),t._v(" /dev/vdb1\n")])])]),a("p",[t._v("参照挂载点卸载。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("umount")]),t._v(" /media/data\n")])])]),a("p",[t._v("没有指定文件系统类型 "),a("code",[t._v("-t")]),t._v(" 时，"),a("code",[t._v("mount")]),t._v(" 会自动检测 "),a("code",[t._v("/dev/sdb1")]),t._v(" 的文件系统类型并进行挂载。")]),t._v(" "),a("p",[a("code",[t._v("mount")]),t._v(" 会尝试读取 "),a("code",[t._v("/dev/sdb1")]),t._v(" 的超级块（superblock），检查其文件系统类型。这通常使用 "),a("code",[t._v("blkid")]),t._v(" 或 "),a("code",[t._v("fstype")]),t._v(" 机制来探测。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("blkid /dev/vdb1\n")])])]),a("p",[a("strong",[t._v("挂载选项")]),t._v("：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("rw")]),t._v("：以读写模式挂载。")]),t._v(" "),a("li",[a("code",[t._v("relatime")]),t._v("：相对访问时间（减少 "),a("code",[t._v("atime")]),t._v(" 更新，提高性能）。")])]),t._v(" "),a("p",[t._v("查看 "),a("code",[t._v("mount")]),t._v(" 具体使用的选项，可以运行：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" /media/data\nfindmnt /media/data\n")])])])])}),[],!1,null,null,null);a.default=v.exports}}]);