(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{474:function(e,t,n){"use strict";n.r(t);var a=n(27),o=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"wpf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#wpf"}},[e._v("#")]),e._v(" WPF")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/overview/",target:"_blank",rel:"noopener noreferrer"}},[e._v("WPF for .NET"),t("OutboundLink")],1),e._v(" 是一个"),t("a",{attrs:{href:"https://github.com/dotnet/wpf",target:"_blank",rel:"noopener noreferrer"}},[e._v("开放源代码框架"),t("OutboundLink")],1),e._v("，它从原始 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/getting-started/",target:"_blank",rel:"noopener noreferrer"}},[e._v("WPF for .NET Framework"),t("OutboundLink")],1),e._v(" 源代码派生而来。")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://dotnet.microsoft.com/zh-cn/download",target:"_blank",rel:"noopener noreferrer"}},[e._v(".NET"),t("OutboundLink")],1),e._v(" 与 "),t("a",{attrs:{href:"https://dotnet.microsoft.com/zh-cn/download/dotnet-framework",target:"_blank",rel:"noopener noreferrer"}},[e._v(".NET Framework"),t("OutboundLink")],1),e._v(" 上的 WPF 之间具有一些"),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/migration/differences-from-net-framework",target:"_blank",rel:"noopener noreferrer"}},[e._v("差异"),t("OutboundLink")],1),e._v("。")]),e._v(" "),t("h2",{attrs:{id:"一、创建应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、创建应用"}},[e._v("#")]),e._v(" 一、创建应用")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/get-started/create-app-visual-studio?view=netdesktop-8.0",target:"_blank",rel:"noopener noreferrer"}},[e._v("教程：使用 .NET 创建新的 WPF 应用"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/visualstudio/ide/how-to-specify-an-application-icon-visual-basic-csharp?view=vs-2022",target:"_blank",rel:"noopener noreferrer"}},[e._v("指定应用程序图标"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"二、数据绑定"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、数据绑定"}},[e._v("#")]),e._v(" 二、数据绑定")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/data/?view=netdesktop-8.0",target:"_blank",rel:"noopener noreferrer"}},[e._v("数据绑定"),t("OutboundLink")],1),e._v("为应用呈现数据并与数据交互提供了一种简单而一致的方法。")]),e._v(" "),t("h3",{attrs:{id:"绑定模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#绑定模式"}},[e._v("#")]),e._v(" 绑定模式")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.data.binding",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("Binding")]),t("OutboundLink")],1),e._v(" 有一个重要的属性 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.data.binding.mode#system-windows-data-binding-mode",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("Mode")]),t("OutboundLink")],1),e._v("，实现绑定中的"),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/data/#direction-of-the-data-flow",target:"_blank",rel:"noopener noreferrer"}},[e._v("数据流向"),t("OutboundLink")],1),e._v("。")]),e._v(" "),t("h4",{attrs:{id:"onetime"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#onetime"}},[e._v("#")]),e._v(" OneTime")]),e._v(" "),t("p",[e._v("当应用程序启动或 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.frameworkelement.datacontext",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("DataContext")]),t("OutboundLink")],1),e._v(" 更改时，更新绑定目标。此绑定类型实质上是 "),t("code",[e._v("OneWay")]),e._v(" 绑定的简化形式，在源值不更改的情况下可以提供更好的性能。")]),e._v(" "),t("h4",{attrs:{id:"oneway"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#oneway"}},[e._v("#")]),e._v(" OneWay")]),e._v(" "),t("p",[e._v("当绑定源更改时，更新绑定目标属性。")]),e._v(" "),t("p",[e._v("这个示例是根据 "),t("code",[e._v("ListBox")]),e._v(" 中的选中项，去改变 "),t("code",[e._v("TextBlock")]),e._v(" 的背景色。将 "),t("code",[e._v("TextBlock")]),e._v(" 的背景色绑定到在 "),t("code",[e._v("ListBox")]),e._v(" 中选择的颜色。")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<StackPanel>\n    <TextBlock\n        Width="300"\n        Height="30"\n        Text="颜色：" />\n    <ListBox\n        x:Name="listColor"\n        Width="300"\n        Height="100">\n        <ListBoxItem Content="Blue" />\n        <ListBoxItem Content="Red" />\n        <ListBoxItem Content="Green" />\n        <ListBoxItem Content="Gray" />\n        <ListBoxItem Content="Cyan" />\n        <ListBoxItem Content="GreenYellow" />\n        <ListBoxItem Content="Orange" />\n    </ListBox>\n    <TextBlock\n        Width="300"\n        Height="Auto"\n        Text="改变背景色：" />\n    <TextBlock\n        Width="300"\n        Height="30"\n        Background="{Binding ElementName=listColor, Path=SelectedItem.Content, Mode=OneWay}" />\n</StackPanel>\n')])])]),t("h4",{attrs:{id:"twoway"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#twoway"}},[e._v("#")]),e._v(" TwoWay")]),e._v(" "),t("p",[e._v("对源属性或目标属性的更改可自动更新对方。此绑定类型适用于可编辑窗体或其他完全交互式 UI 方案。")]),e._v(" "),t("p",[e._v("这个示例中，对 "),t("code",[e._v("TextBox")]),e._v(" 使用 "),t("code",[e._v("TwoWay")]),e._v(" 绑定模式，在 "),t("code",[e._v("ListBox")]),e._v(" 中选择一种颜色后，该颜色就会显示在 "),t("code",[e._v("TextBox")]),e._v(" 中，并且其背景色也会随之相应变化。如果在 "),t("code",[e._v("TextBox")]),e._v(" 中键入了一种颜色，"),t("code",[e._v("ListBox")]),e._v(" 中刚才选中的颜色名称就会被更新，当鼠标再次点击这条修改后的数据时，新值就会被再次发送到 "),t("code",[e._v("TextBox")]),e._v(" 上。这意味着 "),t("code",[e._v("TextBlock")]),e._v(" 也会随之改变。")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<StackPanel>\n    <TextBlock\n        Width="300"\n        Height="30"\n        Text="颜色：" />\n    <ListBox\n        x:Name="listColor"\n        Width="300"\n        Height="100">\n        <ListBoxItem Content="Blue" />\n        <ListBoxItem Content="Red" />\n        <ListBoxItem Content="Green" />\n        <ListBoxItem Content="Gray" />\n        <ListBoxItem Content="Cyan" />\n        <ListBoxItem Content="GreenYellow" />\n        <ListBoxItem Content="Orange" />\n    </ListBox>\n    <TextBlock\n        Width="300"\n        Height="Auto"\n        Text="改变背景色：" />\n    <TextBlock\n        Width="300"\n        Height="30"\n        Background="{Binding ElementName=listColor, Path=SelectedItem.Content, Mode=OneWay}"\n        Text="{Binding ElementName=listColor, Path=SelectedItem.Content, Mode=OneWay}" />\n    <TextBox\n        Name="txtTwoWay"\n        Background="{Binding ElementName=listColor, Path=SelectedItem.Content, Mode=OneWay}"\n        Text="{Binding ElementName=listColor, Path=SelectedItem.Content, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />\n</StackPanel>\n')])])]),t("h3",{attrs:{id:"绑定对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#绑定对象"}},[e._v("#")]),e._v(" 绑定对象")]),e._v(" "),t("p",[e._v("在数据驱动的应用程序中，更常见的情况是创建从一个对象中提起数据的绑定表达式。绑定的信息必须存储在一个公有属性中。因为 WPF 绑定不能获取私有信息或公有字段。")]),e._v(" "),t("p",[e._v("下面演示如何在 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/data/binding-declarations-overview#declare-a-binding-in-xaml",target:"_blank",rel:"noopener noreferrer"}},[e._v("XAML"),t("OutboundLink")],1),e._v(" 中使用 "),t("code",[e._v("DataContext")]),e._v(" 属性来绑定一个自定义对象的属性。")]),e._v(" "),t("p",[e._v("第一步，先创建一个视图模型，命名为 "),t("code",[e._v("YourViewModel")]),e._v("。")]),e._v(" "),t("div",{staticClass:"language-c# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("public class YourViewModel : INotifyPropertyChanged\n{\n    private string _username;\n    public string Username\n    {\n        get { return _username; }\n        set\n        {\n            if (_username != value)\n            {\n                _username = value;\n                OnPropertyChanged(nameof(Username));\n            }\n        }\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n    protected void OnPropertyChanged(string propertyName)\n    {\n        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));\n    }\n}\n")])])]),t("p",[e._v("第二步，源数据对象已准备好了，接下来设计 WPF 界面来让控件绑定源对象，具体的 XAML 代码如下所示。")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<StackPanel Margin="50">\n    <StackPanel Margin="10" Orientation="Horizontal">\n        <TextBlock Text="姓名：" />\n        <TextBlock Width="100" Text="{Binding Path=Username}" />\n    </StackPanel>\n    <StackPanel Margin="10" Orientation="Horizontal">\n        <Button Click="changeName_Click" Content="改变姓名" />\n    </StackPanel>\n</StackPanel>\n')])])]),t("p",[e._v("最后，对应的后台代码逻辑如下所示。")]),e._v(" "),t("div",{staticClass:"language-c# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('public partial class MainWindow : Window\n{\n    private readonly YourViewModel YourVM;\n    public MainWindow()\n    {\n        InitializeComponent();\n        YourVM = new YourViewModel() { Username = "SYY"};\n        this.DataContext = YourVM;\n    }\n\n    private void changeName_Click(object sender, RoutedEventArgs e)\n    {\n        YourVM.Username = "Learning";\n    }\n}\n')])])]),t("h3",{attrs:{id:"字符串格式化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#字符串格式化"}},[e._v("#")]),e._v(" 字符串格式化")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.data.bindingbase.stringformat?view=windowsdesktop-8.0",target:"_blank",rel:"noopener noreferrer"}},[e._v("StringFormat"),t("OutboundLink")],1),e._v(" 获取或设置一个字符串，该字符串指定在绑定值显示为字符串时如何"),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/standard/base-types/formatting-types",target:"_blank",rel:"noopener noreferrer"}},[e._v("格式化"),t("OutboundLink")],1),e._v("绑定。")]),e._v(" "),t("p",[e._v("日期格式：")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<syncfusion:GridTextColumn\n    DisplayBinding="{Binding Path=OrderDate, StringFormat=\'{}{0:yyyy-MM-dd}\'}"\n    HeaderText="订单日期"\n    MappingName="OrderDate" />\n')])])]),t("p",[e._v("定点小数格式：")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<syncfusion:GridTextColumn\n    DisplayBinding="{Binding Path=OrderQuantity, StringFormat=\'{}{0:F2}\'}"\n    HeaderText="订单数量"\n    MappingName="OrderQuantity" />\n')])])]),t("p",[e._v("货币格式：")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<syncfusion:GridTextColumn\n    DisplayBinding="{Binding Path=SalesUnitPrice, StringFormat=\'{}{0:C2}\', ConverterCulture=\'zh-CN\'}"\n    HeaderText="销售单价"\n    MappingName="SalesUnitPrice" />\n')])])]),t("p",[e._v("百分比格式：")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<syncfusion:GridTextColumn\n    DisplayBinding="{Binding Path=GrossMargin, StringFormat=\'{}{0:P2}\'}"\n    HeaderText="毛利率"\n    MappingName="GrossMargin" />\n')])])]),t("h2",{attrs:{id:"三、命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、命令"}},[e._v("#")]),e._v(" 三、命令")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/advanced/commanding-overview?view=netframeworkdesktop-4.8",target:"_blank",rel:"noopener noreferrer"}},[e._v("命令"),t("OutboundLink")],1),e._v("是 WPF 中的一种输入机制。")]),e._v(" "),t("p",[e._v("WPF 命令模型具有四个重要元素，分别为"),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/advanced/commanding-overview?view=netframeworkdesktop-4.8#commands",target:"_blank",rel:"noopener noreferrer"}},[e._v("命令"),t("OutboundLink")],1),e._v("、"),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/advanced/commanding-overview?view=netframeworkdesktop-4.8#command-sources",target:"_blank",rel:"noopener noreferrer"}},[e._v("命令源"),t("OutboundLink")],1),e._v("、"),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/advanced/commanding-overview?view=netframeworkdesktop-4.8#command-target",target:"_blank",rel:"noopener noreferrer"}},[e._v("命令目标"),t("OutboundLink")],1),e._v("和"),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/advanced/commanding-overview?view=netframeworkdesktop-4.8#commandbinding",target:"_blank",rel:"noopener noreferrer"}},[e._v("命令绑定"),t("OutboundLink")],1),e._v("。")]),e._v(" "),t("p",[e._v("WPF 命令模型的核心在于 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.icommand",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("ICommand")]),t("OutboundLink")],1),e._v(" 接口，该接口定义命令的工作原理。")]),e._v(" "),t("div",{staticClass:"language-c# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("public interface ICommand\n{\n    event EventHandler CanExecuteChanged;\n    bool CanExecute(object parameter);\n    void Execute(object parameter);\n}\n")])])]),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.icommand",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("ICommand")]),t("OutboundLink")],1),e._v(" 公开了两种方法 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.icommand.execute#system-windows-input-icommand-execute(system-object)",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("Execute")]),t("OutboundLink")],1),e._v(" 和 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.icommand.canexecute#system-windows-input-icommand-canexecute(system-object)",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("CanExecute")]),t("OutboundLink")],1),e._v("，以及一个事件 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.icommand.canexecutechanged#system-windows-input-icommand-canexecutechanged",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("CanExecuteChanged")]),t("OutboundLink")],1),e._v("。")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.icommand.execute#system-windows-input-icommand-execute(system-object)",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("Execute")]),t("OutboundLink")],1),e._v(" 执行与该命令关联的操作。")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.icommand.canexecute#system-windows-input-icommand-canexecute(system-object)",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("CanExecute")]),t("OutboundLink")],1),e._v(" 确定是否可以在当前命令目标上执行该命令。例如，文本框中没有选择任何文本，此时 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.applicationcommands.copy#system-windows-input-applicationcommands-copy",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("Copy")]),t("OutboundLink")],1),e._v(" 命令是不可用的，"),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.icommand.canexecute#system-windows-input-icommand-canexecute(system-object)",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("CanExecute")]),t("OutboundLink")],1),e._v(" 则返回 "),t("code",[e._v("false")]),e._v("。")]),e._v(" "),t("p",[e._v("实际上，"),t("code",[e._v("Execute")]),e._v(" 和 "),t("code",[e._v("CanExecute")]),e._v(" 方法并没有包含命令的处理逻辑，而是将触发遍历元素树的事件来查找具有 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.commandbinding",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("CommandBinding")]),t("OutboundLink")],1),e._v(" 的对象，真正命令的处理程序包含在 "),t("code",[e._v("CommandBinding")]),e._v(" 的事件处理程序中。")]),e._v(" "),t("p",[e._v("执行过程如下：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("1、按钮点击：当用户点击按钮时，按钮的 Command 属性（ApplicationCommands.New）被触发。\n2、调用 RoutedCommand.Execute：ApplicationCommands.New.Execute 方法被调用。\n3、触发事件：Execute 方法触发 Executed 路由事件。\n4、查找 CommandBinding：WPF 在元素树中查找与 ApplicationCommands.New 绑定的 CommandBinding。\n5、调用处理程序：找到 CommandBinding 后，调用 Executed 事件处理程序，即 NewCommandExecuted 方法。\n6、显示消息：NewCommandExecuted 方法执行，显示消息框。\n")])])]),t("h3",{attrs:{id:"内置命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内置命令"}},[e._v("#")]),e._v(" 内置命令")]),e._v(" "),t("p",[e._v("在 WPF 中，"),t("code",[e._v("CommandBinding")]),e._v(" 和 "),t("code",[e._v("Command")]),e._v(" 是实现命令模式的一部分，用于将用户界面操作与命令逻辑分离。这使得代码更模块化和更容易维护。")]),e._v(" "),t("h4",{attrs:{id:"命令绑定"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令绑定"}},[e._v("#")]),e._v(" 命令绑定")]),e._v(" "),t("p",[e._v("在 XAML 中创建命令绑定。")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<Window.CommandBindings>\n    <CommandBinding Command="ApplicationCommands.New" Executed="NewCommand" />\n</Window.CommandBindings>\n')])])]),t("p",[e._v("在 C# 中创建命令绑定。")]),e._v(" "),t("div",{staticClass:"language-c# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("public MainWindow()\n{\n    InitializeComponent();\n    CommandBinding bindingNew = new CommandBinding(ApplicationCommands.New);\n    bindingNew.Executed += NewCommand;\n    this.CommandBindings.Add(bindingNew);\n}\n")])])]),t("h4",{attrs:{id:"绑定执行方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#绑定执行方法"}},[e._v("#")]),e._v(" 绑定执行方法")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.input.applicationcommands.new#system-windows-input-applicationcommands-new",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("ApplicationCommands.New")]),t("OutboundLink")],1),e._v(" 是 WPF 提供的一个预定义命令，表示新建操作。"),t("code",[e._v('Executed="NewCommand"')]),e._v(" 用于指定当命令被执行时应该调用的方法。")]),e._v(" "),t("div",{staticClass:"language-c# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('private void NewCommand(object sender, ExecutedRoutedEventArgs e)\n{\n    MessageBox.Show("New 命令被触发了，命令源是：" + e.Source.ToString());\n}\n')])])]),t("h4",{attrs:{id:"命令源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令源"}},[e._v("#")]),e._v(" 命令源")]),e._v(" "),t("p",[e._v("在 XAML 中，设置命令源。")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<StackPanel>\n    <Button\n        Margin="5"\n        Padding="5"\n        Command="ApplicationCommands.New"\n        ToolTip="{x:Static ApplicationCommands.New}">\n        New\n    </Button>\n    <Button\n        Margin="5"\n        Padding="5"\n        Command="ApplicationCommands.New"\n        Content="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}" />\n</StackPanel>\n')])])]),t("h4",{attrs:{id:"事件调用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事件调用"}},[e._v("#")]),e._v(" 事件调用")]),e._v(" "),t("p",[e._v("除了在 XAML 中设置命令源，还可以绑定事件方法，手动调用命令。")]),e._v(" "),t("div",{staticClass:"language-c# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("private void DoCommand_Click(object sender, RoutedEventArgs e)\n{\n    // 直接调用命令的两种方式\n    ApplicationCommands.New.Execute(null, (Button)sender);\n    //  this.CommandBindings[0].Command.Execute(null);\n}\n")])])]),t("p",[e._v("然后在 XAML 中绑定事件方法。")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<StackPanel>\n    <Button\n        Margin="5"\n        Padding="5"\n        Click="DoCommand_Click">\n        DoCommand\n    </Button>\n</StackPanel>\n')])])]),t("h3",{attrs:{id:"自定义命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自定义命令"}},[e._v("#")]),e._v(" 自定义命令")]),e._v(" "),t("h4",{attrs:{id:"实现命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实现命令"}},[e._v("#")]),e._v(" 实现命令")]),e._v(" "),t("p",[e._v("自定义实现一个命令，如 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/communitytoolkit/mvvm/relaycommand",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("RelayCommand")]),t("OutboundLink")],1),e._v("。")]),e._v(" "),t("div",{staticClass:"language-c# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("public class RelayCommand : ICommand\n{\n    private readonly Action<object> execute;\n    private readonly Predicate<object> canExecute;\n\n    public RelayCommand(Action<object> execute, Predicate<object> canExecute = null)\n    {\n        this.execute = execute ?? throw new ArgumentNullException(nameof(execute));\n        this.canExecute = canExecute;\n    }\n\n    public bool CanExecute(object parameter)\n    {\n        return canExecute == null || canExecute(parameter);\n    }\n\n    public void Execute(object parameter)\n    {\n        execute(parameter);\n    }\n\n    public event EventHandler CanExecuteChanged\n    {\n        add { CommandManager.RequerySuggested += value; }\n        remove { CommandManager.RequerySuggested -= value; }\n    }\n}\n")])])]),t("h4",{attrs:{id:"命令绑定-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令绑定-2"}},[e._v("#")]),e._v(" 命令绑定")]),e._v(" "),t("p",[e._v("在 "),t("code",[e._v("ViewModel")]),e._v(" 中实例化命令。")]),e._v(" "),t("div",{staticClass:"language-c# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("public class YourViewModel\n{\n    public ICommand MyCommand { get; }\n\n    public YourViewModel()\n    {\n        MyCommand = new RelayCommand(ExecuteMyCommand, CanExecuteMyCommand);\n    }\n\n    private void ExecuteMyCommand(object parameter)\n    {\n        // 执行命令的逻辑\n    }\n\n    private bool CanExecuteMyCommand(object parameter)\n    {\n        // 判断命令是否可以执行的逻辑\n        return true;\n    }\n}\n")])])]),t("p",[e._v("在 XAML 中绑定命令。")]),e._v(" "),t("div",{staticClass:"language-xaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<Window\n    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"\n    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"\n    xmlns:local="clr-namespace:DataBinding"\n    d:DataContext="{d:DesignInstance local:YourViewModel}">\n    <StackPanel>\n        <Button\n            Margin="5"\n            Padding="5"\n            Command="{Binding MyCommand}"\n            Content="Execute Command" />\n    </StackPanel>\n</Window>\n')])])]),t("h2",{attrs:{id:"四、异常"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、异常"}},[e._v("#")]),e._v(" 四、异常")]),e._v(" "),t("h3",{attrs:{id:"编译错误"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编译错误"}},[e._v("#")]),e._v(" 编译错误")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("当前上下文中不存在名称 "),t("code",[e._v("InitializeComponent")])]),e._v(" "),t("p",[e._v("在 VS 中，如果 XAML 的后台代码提示不存在 "),t("code",[e._v("InitializeComponent")]),e._v("，尝试将 XAML 的属性从"),t("strong",[e._v("页")]),e._v("更改为其他，再更改回"),t("strong",[e._v("页")]),e._v("，会自动选择 "),t("code",[e._v("MSBuild:Compile")]),e._v("。")])])]),e._v(" "),t("h3",{attrs:{id:"运行错误"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行错误"}},[e._v("#")]),e._v(" 运行错误")]),e._v(" "),t("h4",{attrs:{id:"查看事件日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看事件日志"}},[e._v("#")]),e._v(" 查看事件日志")]),e._v(" "),t("p",[e._v("Windows 事件查看器是排查应用程序崩溃问题的一个重要工具。")]),e._v(" "),t("p",[e._v("按 "),t("code",[e._v("Win + R")]),e._v(" 打开运行对话框，输入 "),t("code",[e._v("eventvwr")]),e._v(" 并按回车。")]),e._v(" "),t("p",[e._v("在事件查看器中，导航到 "),t("code",[e._v("Windows Logs > Application")]),e._v("。")]),e._v(" "),t("p",[e._v("查找有关应用程序崩溃的错误日志。它们通常标记为 "),t("code",[e._v("Error")]),e._v(" 或 "),t("code",[e._v("Critical")]),e._v("，并且来源可能是 "),t("code",[e._v(".NET Runtime")]),e._v(" 或 "),t("code",[e._v("Application Error")]),e._v("。")]),e._v(" "),t("p",[e._v("这些日志会包含崩溃的详细信息，如异常类型、错误消息和堆栈跟踪。")]),e._v(" "),t("h2",{attrs:{id:"五、部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、部署"}},[e._v("#")]),e._v(" 五、部署")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/app-development/building-and-deploying-wpf-applications?view=netframeworkdesktop-4.8",target:"_blank",rel:"noopener noreferrer"}},[e._v("生成和部署"),t("OutboundLink")],1),e._v("模型提供在本地和远程生成和部署应用程序的功能。")]),e._v(" "),t("h3",{attrs:{id:"windows-installer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows-installer"}},[e._v("#")]),e._v(" Windows Installer")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/app-development/deploying-a-wpf-application-wpf?view=netframeworkdesktop-4.8#windows-installer",target:"_blank",rel:"noopener noreferrer"}},[e._v("Windows Installer"),t("OutboundLink")],1),e._v(" 允许应用程序打包为可轻松分发到客户端并运行的自包含可执行文件。")]),e._v(" "),t("p",[e._v("如果需要比 ClickOnce 提供的更为复杂的桌面应用程序安装，则可以创建 "),t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/visualstudio/deployment/deploying-applications-services-and-components?view=vs-2022#create-an-installer-package-windows-desktop-1",target:"_blank",rel:"noopener noreferrer"}},[e._v("Windows Installer"),t("OutboundLink")],1),e._v(" 包或自定义引导程序。")]),e._v(" "),t("h4",{attrs:{id:"visual-studio-installer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#visual-studio-installer"}},[e._v("#")]),e._v(" Visual Studio Installer")]),e._v(" "),t("p",[e._v("可以使用 "),t("a",{attrs:{href:"https://aka.ms/vdproj-docs",target:"_blank",rel:"noopener noreferrer"}},[e._v("vdproj"),t("OutboundLink")],1),e._v(" 创建 MSI 或 EXE 安装程序包。")]),e._v(" "),t("p",[e._v("通常使用 Visual Studio "),t("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=VisualStudioClient.MicrosoftVisualStudio2022InstallerProjects",target:"_blank",rel:"noopener noreferrer"}},[e._v("安装程序项目扩展"),t("OutboundLink")],1),e._v("将应用程序打包为 MSI。")]),e._v(" "),t("ul",[t("li",[t("p",[t("strong",[e._v("创建安装项目")])]),e._v(" "),t("p",[e._v("在解决方案上新建项目，选择 "),t("code",[e._v("Setup Project")]),e._v(" 项目。")]),e._v(" "),t("p",[e._v("File System 有三个目录：")]),e._v(" "),t("ul",[t("li",[t("strong",[e._v("Application Folder")]),e._v("：安装程序的根目录，编写的程序生成的 dll，安装后就存放在这个目录。")]),e._v(" "),t("li",[t("strong",[e._v("User's Desktop")]),e._v("：用户桌面快捷方式设置。")]),e._v(" "),t("li",[t("strong",[e._v("User's Programs Menu")]),e._v("：用户启动菜单的快捷方式设置。")])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("添加项目输出")])]),e._v(" "),t("p",[e._v("安装项目建好后，需要往里面添加项目输出。")]),e._v(" "),t("p",[e._v("在弹出的页面中，它会默认选中需要打包的程序集和发布项，点击确定即可。")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("设置项目属性")])]),e._v(" "),t("p",[e._v("项目属性的设置，是用于生成安装程序的描述信息，主要内容有程序的作者，标题，公司信息，技术支持等等。")]),e._v(" "),t("p",[e._v("项目属性的设置方式为：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("1、左键选中安装项目。\n2、点击解决方案栏左下角的属性。\n")])])]),t("p",[e._v("⼀般情况，修改 "),t("code",[e._v("Author")]),e._v("、"),t("code",[e._v("Description")]),e._v("、"),t("code",[e._v("Manufacturer")]),e._v("、"),t("code",[e._v("ProductName")]),e._v("、"),t("code",[e._v("Title")]),e._v(" 属性即可。")])])])])}),[],!1,null,null,null);t.default=o.exports}}]);